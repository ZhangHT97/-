# 融合分段编码与仿射机制的相似案例匹配-code

硬件环境必备：GPU （参考：**Tesla k80 **, **cuda-v:**11.2)

## 终端操作：

### 1、配置环境：(py3.6)

```shell
pip install -r requirements.txt
```

### 2、数据及获取：

```shell
python data.py
```

### 3、数据预处理

```shell
python data_process.py
```

*第一次运行需要取消注释**data_process.py**中的如下代码：*

```python
data_clean = open('data/train/input_clean.txt', 'w+', encoding='utf-8')
data_process('data/train/input.txt',test = False)
print("已完成训练数据预处理")
data_clean = open('data/valid/input_clean.txt', 'w+', encoding='utf-8')
data_process('data/valid/input.txt',test = True)
print("已完成验证数据预处理")
data_clean = open('data/test/input_clean.txt', 'w+', encoding='utf-8')
data_process('data/test/input.txt', test=True)
print("已完成测试数据预处理")
```

### 4、训练模型

```shell
python train.py
```

*参数配置在train.py里面进行更改*

### 5、测试模型（测试结果会比论文中的值略高，是因为利用了预训练的word2vec）

```shell
python test.py
```

显示结果为**acc_for_test：**最后一个轮次保存的模型：Acc、P、R、F1

**acc for best_test_acc：**验证集上最好的模型：Acc、P、R、F1

### 6、使用模型

```shell
python pred.py
*****************使用展示****************
》》'python pred.py'
》》'Building prefix dict from the default dictionary ... Loading model from cache C:\Users\Lenovo\AppData\Local\Temp\jieba.cache Loading model cost 0.772 seconds.Prefix dict has been built successfully.'
》》'请输入A:'原告刘少选向本院提出诉讼请求：依法判令被告支付其11.8万元。事实和理由：2016年4月6日，被告于其签订邵原机械厂六层砖混楼工程承包合同，被告要求其先交合同押金50000元，承诺三天内开始施工，后来却以各种借口与理由不开工；2016年7月28日，在其与被告多次沟通后，被告却说需要先结清工地施工以前的费用，然后才能开工，并要求其再次给被告68000元用于周转，同时承诺一个月内将这68000元连本带息还给其，可之后，被告不再接听电话，也未还款，更没有让其施工。 被告李庆杰辩称，原告所述属实，对数额无异议。 当事人围绕诉讼请求依法提交了证据，双方对如下证据的真实性无异议，本院予以确认并在卷佐证：1、2016年4月6日，被告出具的收到条一份；2、2017年1月28日被告出具的借据一份；3、中国农业银行回单一份；4、建筑工程施工项目承包合同一份。 本院经审理认定事实如下：被告李庆杰为济源市邵原机械制造厂的法定代表人。2016年4月6日，原告刘少选及他人姚少伟与济源市邵原机械制造厂签订建筑工程施工项目承包合同。原告刘少选及他人姚少伟按被告要求交合同押金50000元，后一直至今未开工。2016年7月28日，被告向原告借款68000元，并给原告出具借据一份，载明：“今借到刘少选现金陆万捌仟元整68000.00元。》李国军2017.7.28号”。该款至今未还。 \n"
》》'请输入B:'原告卢俊琳诉称，被告以生产资金周转为由向原告借款5万元。并向原告出具《借条》予以确认。之后被告未能及时偿还借款本金，已严重侵害原告的合法权益。为维护原告的合法权益，故向法院起诉，请求依法判令被告归还原告借款本金50000元及利息3357元（利息计算，1、以借款本金4万元为基数，自2015年6月15日起至2016年4月21日止；2、以借款1万元为基数，从2015年6月12日至2016年4月21日，按银行贷款月利率7.9％计付），本案的诉讼费由被告承担。 原告卢俊琳为证明自己的主张，向本院提交的证据有：借条2份，拟证明被告韦贵腾向原告借款的事实。 被告韦贵腾未答辩亦未提交任何书面证据。 经本院审理查明：被告韦贵腾因生意资金周转需要分两次向原告借款，共计50000元，并出具借条二张给原告卢俊琳收执，2015年5月12日的借条载明：“今韦贵腾向卢俊琳借款壹万元整（10000）于2015年5月12日止2015年6月12日还款。借款人：韦贵腾，2015年5月12日。”2015年6月15日的借条载明：“今韦贵腾向卢俊琳借款肆万元（40000万元整）于2015年6月15日到2015年7月15日还款。借款人：韦贵腾，2015年6月15日。”后经原告催促，被告迟迟未归还借款。2016年4月21日，原告诉至本院，提出上述诉讼请求。庭审中，原告承认被告偿还其800元。 \n"
》》0.4042359077633822
》》Process finished with exit code 0
```

